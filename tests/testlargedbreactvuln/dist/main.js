!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=11)}([function(t,e,n){(function(t){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},i=/%[sdj%]/g;e.format=function(t){if(!d(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(a(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,s=r.length,o=String(t).replace(i,(function(t){if("%%"===t)return"%";if(n>=s)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),u=r[n];n<s;u=r[++n])y(u)||!b(u)?o+=" "+u:o+=" "+a(u);return o},e.deprecate=function(n,r){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var s,o={};function a(t,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),v(n)?r.showHidden=n:n&&e._extend(r,n),g(r.showHidden)&&(r.showHidden=!1),g(r.depth)&&(r.depth=2),g(r.colors)&&(r.colors=!1),g(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),f(r,t,r.depth)}function u(t,e){var n=a.styles[e];return n?"["+a.colors[n][0]+"m"+t+"["+a.colors[n][1]+"m":t}function c(t,e){return t}function f(t,n,r){if(t.customInspect&&n&&_(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return d(i)||(i=f(t,i,r)),i}var s=function(t,e){if(g(e))return t.stylize("undefined","undefined");if(d(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(m(e))return t.stylize(""+e,"number");if(v(e))return t.stylize(""+e,"boolean");if(y(e))return t.stylize("null","null")}(t,n);if(s)return s;var o=Object.keys(n),a=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(n)),T(n)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return l(n);if(0===o.length){if(_(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(E(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return t.stylize(Date.prototype.toString.call(n),"date");if(T(n))return l(n)}var c,b="",O=!1,k=["{","}"];(h(n)&&(O=!0,k=["[","]"]),_(n))&&(b=" [Function"+(n.name?": "+n.name:"")+"]");return E(n)&&(b=" "+RegExp.prototype.toString.call(n)),w(n)&&(b=" "+Date.prototype.toUTCString.call(n)),T(n)&&(b=" "+l(n)),0!==o.length||O&&0!=n.length?r<0?E(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=O?function(t,e,n,r,i){for(var s=[],o=0,a=e.length;o<a;++o)A(e,String(o))?s.push(p(t,e,n,r,String(o),!0)):s.push("");return i.forEach((function(i){i.match(/^\d+$/)||s.push(p(t,e,n,r,i,!0))})),s}(t,n,r,a,o):o.map((function(e){return p(t,n,r,a,e,O)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(c,b,k)):k[0]+b+k[1]}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,n,r,i,s){var o,a,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),A(r,i)||(o="["+i+"]"),a||(t.seen.indexOf(u.value)<0?(a=y(n)?f(t,u.value,null):f(t,u.value,n-1)).indexOf("\n")>-1&&(a=s?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),g(o)){if(s&&i.match(/^\d+$/))return a;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function h(t){return Array.isArray(t)}function v(t){return"boolean"==typeof t}function y(t){return null===t}function m(t){return"number"==typeof t}function d(t){return"string"==typeof t}function g(t){return void 0===t}function E(t){return b(t)&&"[object RegExp]"===O(t)}function b(t){return"object"==typeof t&&null!==t}function w(t){return b(t)&&"[object Date]"===O(t)}function T(t){return b(t)&&("[object Error]"===O(t)||t instanceof Error)}function _(t){return"function"==typeof t}function O(t){return Object.prototype.toString.call(t)}function k(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(g(s)&&(s=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!o[n])if(new RegExp("\\b"+n+"\\b","i").test(s)){var r=t.pid;o[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else o[n]=function(){};return o[n]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=h,e.isBoolean=v,e.isNull=y,e.isNullOrUndefined=function(t){return null==t},e.isNumber=m,e.isString=d,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=g,e.isRegExp=E,e.isObject=b,e.isDate=w,e.isError=T,e.isFunction=_,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(14);var x=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(){var t=new Date,e=[k(t.getHours()),k(t.getMinutes()),k(t.getSeconds())].join(":");return[t.getDate(),x[t.getMonth()],e].join(" ")}function A(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",S(),e.format.apply(e,arguments))},e.inherits=n(15),e._extend=function(t,e){if(!e||!b(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var L="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function P(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(L&&t[L]){var e;if("function"!=typeof(e=t[L]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,L,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise((function(t,r){e=t,n=r})),i=[],s=0;s<arguments.length;s++)i.push(arguments[s]);i.push((function(t,r){t?n(t):e(r)}));try{t.apply(this,i)}catch(t){n(t)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),L&&Object.defineProperty(e,L,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=L,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return i.apply(s,arguments)};e.apply(this,n).then((function(e){t.nextTick(o,null,e)}),(function(e){t.nextTick(P,e,o)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,r(e)),n}}).call(this,n(13))},function(t,e){var n=function(){function t(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function e(t,e){for(var n=[];e>0;n[--e]=t);return n.join("")}var r=function(){return r.cache.hasOwnProperty(arguments[0])||(r.cache[arguments[0]]=r.parse(arguments[0])),r.format.call(null,r.cache[arguments[0]],arguments)};return r.object_stringify=function(t,e,n,i){var s="";if(null!=t)switch(typeof t){case"function":return"[Function"+(t.name?": "+t.name:"")+"]";case"object":if(t instanceof Error)return"["+t.toString()+"]";if(e>=n)return"[Object]";if(i&&(i=i.slice(0)).push(t),null!=t.length){s+="[";var o=[];for(var a in t)i&&i.indexOf(t[a])>=0?o.push("[Circular]"):o.push(r.object_stringify(t[a],e+1,n,i));s+=o.join(", ")+"]"}else{if("getMonth"in t)return"Date("+t+")";s+="{";o=[];for(var u in t)t.hasOwnProperty(u)&&(i&&i.indexOf(t[u])>=0?o.push(u+": [Circular]"):o.push(u+": "+r.object_stringify(t[u],e+1,n,i)));s+=o.join(", ")+"}"}return s;case"string":return'"'+t+'"'}return""+t},r.format=function(i,s){var o,a,u,c,f,l,p,h=1,v=i.length,y="",m=[];for(a=0;a<v;a++)if("string"===(y=t(i[a])))m.push(i[a]);else if("array"===y){if((c=i[a])[2])for(o=s[h],u=0;u<c[2].length;u++){if(!o.hasOwnProperty(c[2][u]))throw new Error(n('[sprintf] property "%s" does not exist',c[2][u]));o=o[c[2][u]]}else o=c[1]?s[c[1]]:s[h++];if(/[^sO]/.test(c[8])&&"number"!=t(o))throw new Error(n('[sprintf] expecting number but found %s "'+o+'"',t(o)));switch(c[8]){case"b":o=o.toString(2);break;case"c":o=String.fromCharCode(o);break;case"d":o=parseInt(o,10);break;case"e":o=c[7]?o.toExponential(c[7]):o.toExponential();break;case"f":o=c[7]?parseFloat(o).toFixed(c[7]):parseFloat(o);break;case"O":o=r.object_stringify(o,0,parseInt(c[7])||5);break;case"o":o=o.toString(8);break;case"s":o=(o=String(o))&&c[7]?o.substring(0,c[7]):o;break;case"u":o=Math.abs(o);break;case"x":o=o.toString(16);break;case"X":o=o.toString(16).toUpperCase()}o=/[def]/.test(c[8])&&c[3]&&o>=0?"+"+o:o,l=c[4]?"0"==c[4]?"0":c[4].charAt(1):" ",p=c[6]-String(o).length,f=c[6]?e(l,p):"",m.push(c[5]?o+f:f+o)}return m.join("")},r.cache={},r.parse=function(t){for(var e=t,n=[],r=[],i=0;e;){if(null!==(n=/^[^\x25]+/.exec(e)))r.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(e)))r.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosOuxX])/.exec(e)))throw new Error("[sprintf] "+e);if(n[2]){i|=1;var s=[],o=n[2],a=[];if(null===(a=/^([a-z_][a-z_\d]*)/i.exec(o)))throw new Error("[sprintf] "+o);for(s.push(a[1]);""!==(o=o.substring(a[0].length));)if(null!==(a=/^\.([a-z_][a-z_\d]*)/i.exec(o)))s.push(a[1]);else{if(null===(a=/^\[(\d+)\]/.exec(o)))throw new Error("[sprintf] "+o);s.push(a[1])}n[2]=s}else i|=2;if(3===i)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r.push(n)}e=e.substring(n[0].length)}return r},r}();t.exports=n,n.sprintf=n,n.vsprintf=function(t,e){var r=e.slice();return r.unshift(t),n.apply(null,r)}},function(t,e,n){"use strict";var r=n(18).EventEmitter2,i={wildcard:!0,delimiter:".",maxListeners:30},s={FLOW_BEGIN:"flow.begin",TASK_BEGIN:"task.begin",TASK_COMPLETE:"task.complete",TASK_ERRORED:"task.errored",FLOW_COMPLETE:"flow.complete",FLOW_ERRORED:"flow.errored",EXEC_FLOW_START:"exec.flow.start",EXEC_INPUT_PREPROCESS:"exec.input.preprocess",EXEC_TASKS_PRECREATE:"exec.tasks.precreate",EXEC_OUTTASK_CREATE:"exec.outTask.create",EXEC_TASK_START:"exec.task.start",EXEC_TASK_COMPLETE:"exec.task.complete",EXEC_TASK_ERRORED:"exec.task.errored",EXEC_FLOW_COMPLETE:"exec.flow.complete",EXEC_FLOW_ERRORED:"exec.flow.errored"};function o(){}o.create=function(){return new o},o.TYPES=s,o.prototype.TYPES=s,o.prototype.isEnabled=function(){return this.emitter||this.parent&&this.parent.isEnabled()},o.prototype.on=function(t,e){this.emitter||(this.emitter=new r(i)),"*"===t?this.emitter.onAny(e):this.emitter.on(t,e)},o.prototype.emit=function(t,e,n,r){if(void 0===t)throw new Error("event is undefined");this.emitter&&this.emitter.emit.apply(this.emitter,arguments),this.parent&&this.parent.isEnabled()&&this.parent.emit.apply(this.parent,arguments)},o.prototype.removeListener=function(t,e){this.emitter&&this.emitter.removeListener.apply(this.emitter,arguments)},t.exports=o,t.exports.global=o.create()},function(t,e,n){"use strict";t.exports={READY:"ready",RUNNING:"running",ERRORED:"errored",COMPLETE:"complete"}},function(t,e,n){"use strict";var r=n(9);t.exports=n(29),t.exports.options=r.options,t.exports.events=r.events,t.exports.logEvents=function(t,e){return e||"string"!=typeof t||(e=t,t=void 0),n(26).logEvents(t,e)},t.exports.resolvePromises=function(){n(27)},t.exports.trackTasks=function(){n(28)}},function(t,e,n){"use strict";var r=n(6),i=n(3),s=n(2);function o(){}o.prototype.getOutParams=function(){return r(this.out)},o.prototype.isComplete=function(){return this.status===i.COMPLETE},o.prototype.start=function(t){this.args=t,this.env.currentTask=this,this.env.flowEmitter.emit(s.TYPES.EXEC_TASK_START,this)},o.prototype.complete=function(t){this.status=i.COMPLETE,this.results=t,this.env.currentTask=this,this.env.flowEmitter.emit(s.TYPES.EXEC_TASK_COMPLETE,this)},o.prototype.functionExists=function(t){var e=this.f;if(!e)return!1;if(e instanceof Function)return!0;if("string"==typeof e){var n=t.getVar(e);if(n&&n instanceof Function)return!0}return!1},o.prototype.areAllDepArgsDefined=function(t){return this.a.every((function(e){return void 0!==t.getVar(e)}))},o.prototype.depTasksAreDone=function(t){return!this.after||!this.after.length||this.after.every((function(e){return t[e].isComplete()}))},o.prototype.parentExists=function(t,e){if(-1===t.indexOf("."))return!0;var n=t.split(".");n.pop();var r=n.reduce((function(t,e){if(null!=t)return t[e]}),e.values);return null!=r},o.prototype.outParentsExist=function(t){var e=this;return this.getOutParams().every((function(n){return null===n||e.parentExists(n,t)}))},o.prototype.isReady=function(t,e){return!this.status&&this.functionExists(t)&&this.areAllDepArgsDefined(t)&&this.depTasksAreDone(e)&&(!this.outParentsExist||this.outParentsExist(t))},o.prototype.isMethodCall=function(){return"string"==typeof this.f&&/^.*\..*$/.test(this.f)},o.prototype.getMethodObj=function(t){var e=this.f;if(e){var n=e.split(".");if(n.pop(),n.length)return n.reduce((function(t,e){if(null!=t)return t[e]}),t.values)}},t.exports=o},function(t,e,n){t.exports=function(){"use strict";return function(t,e,n){if(0===arguments.length)return[];if(1===arguments.length){if(null==t)return[];if(Array.isArray(t))return t}return Array.prototype.slice.call(arguments)}}()},function(t,e,n){"use strict";var r=n(0),i=n(1).sprintf,s=n(6),o=n(17),a=n(19),u=n(20),c=n(21),f=n(22),l=n(23),p=n(3),h=n(10),v=n(8),y=n(2),m={cb:o,ret:u,promise:a,when:c};var d={finalcb:f,finalcbFirst:l};var g,E="function: %s not found in locals or input params - task[%s]",b="task.type should match one of "+Object.keys(m).join(", ");function w(t,e){return i("%s - %s",t,r.inspect(e))}function T(t){return t.type?t:(t.type="cb",t)}function _(t){t.type||(t.type=Object.keys(d)[0])}function O(t){var e=t.reduce((function(t,e){return e.name&&(t[e.name]=e),t}),{});return t.forEach((function(t,n){if(!t.name){var r=(s=t.f)?s.name?s.name:s:"undefined";r&&!e[r]||(r=i("%s_%s",r,n)),t.name=r,e[r]=t}var s})),e}function g(t){return new(0,m[t.type])(t)}e.serializeTasks=function(t){return O(t),t.forEach((function(t,e,n){0!==e&&(t.after=[n[e-1].name])})),t},e.TASK_TYPES=m,e.taskTypeKeys=function(){return Object.keys(m)},e.OUT_TASK_TYPES=d,e.outTaskTypeKeys=function(){return Object.keys(d)},e.setMissingType=T,e.validate=function(t){if(!t||"object"!=typeof t)return[w("task must be an object",t)];T(t),function(t){if(t.after){var e=s(t.after);e=e.map((function(t){return"function"==typeof t?t.name:t})),t.after=e}}(t);var e=[];return e=(e=e.concat(function(t){var e=[];Object.keys(m).some((function(e){return t.type===e}))||e.push(w(b,t));return e}(t))).concat(function(t){var e=[],n=m[t.type];n&&(e=e.concat(n.validate(t)));return e}(t))},e.validateOutTask=function(t){var e=[];_(t);var n=d[t.type];return e=e.concat(n.validate(t))},e.validateLocalFunctions=function(t,e,n){var r=[];function s(){}var o=t.map((function(t){return s})),a=v.create(o,t,n);return e.map(g).filter((function(t){return"when"!==t.type})).forEach((function(t,e){if(!t.functionExists(a))if(t.isMethodCall()){var n=t.getMethodObj(a);n&&n!==s&&r.push(i(E,t.f,e))}else r.push(i(E,t.f,e))})),r},e.nameTasks=O,e.create=g,e.createOutTask=function(t,e,n,r,i,s){_(t);var o={taskDef:t,cbFunc:e,tasks:n,vCon:r,execOptions:i,env:s,TaskConstructor:d[t.type]};return y.global.emit(y.TYPES.EXEC_OUTTASK_CREATE,o),new(0,o.TaskConstructor)(o)},e.createErrorHandler=function(t,e){return function(n,r){n.status=p.ERRORED,n.error=r,e.env.currentTask=n,e.env.flowEmitter.emit(y.TYPES.EXEC_TASK_ERRORED,n);var i=h.augmentError(r,{task:n,vcon:t});e.exec(i)}},e.findReadyAndExec=function(t,e,n,r,s,o){var a=function(t,e,n){return e.filter((function(e){return e.isReady(t,n)}))}(t,e,n);a.length||function(t,e,n,r){if(!e.filter((function(t){return t.status===p.RUNNING||t.status===p.READY})).length){var s=e.filter((function(t){return!t.status})).map((function(t){return t.name})),o=i("no tasks running, flow will not complete, remaining tasks: %s",s.join(", "));n({env:r},new Error(o))}}(0,e,r,o),function(t,e,n,r){t.forEach((function(t){t.status=p.READY})),t.forEach((function(t){t.exec(e,n,r)}))}(a,t,r,s)}},function(t,e,n){"use strict";function r(){}r.prototype.getLastResults=function(){return this.getVar(":LAST_RESULTS")},r.prototype.setLastResults=function(t){this.setVar(":LAST_RESULTS",t)},r.prototype.getVar=function(t){var e=this.values;if("string"!=typeof t)return t;if("true"===(t=t.trim()))return!0;if("false"===t)return!1;if("null"===t)return null;if(/^-?[0-9]+$/.test(t))return parseInt(t,10);if(/^-?[0-9.]+$/.test(t))return parseFloat(t);var n=/^("|')([^\1]*)\1$/.exec(t);return n?n[2]:t.split(".").reduce((function(t,e){if(null!=t)return t[e]}),e)},r.prototype.saveResults=function(t,e){var n=this;t.forEach((function(t,r){n.setVar(t,void 0!==e[r]?e[r]:null)})),this.setLastResults(e)},r.prototype.setVar=function(t,e){if(t){var n=this.values,r=t.split("."),i=r.pop();r.reduce((function(t,e){var n=t[e];return null==n&&(n=t[e]={}),n}),n)[i]=e}},r.create=function(t,e,n,i){var s={};i&&(s.this=i),n&&Object.keys(n).forEach((function(t){s[t]=n[t]}));var o=new r;return o.values=t.reduce((function(t,n,r){var i=e[r];return i&&(t[i]=n),t}),s),o},t.exports=r},function(t,e,n){"use strict";n(12).EventEmitter;var r=n(10),i=n(16),s=n(7),o=(n(3),n(8)),a=n(2),u=n(24),c=n(25),f={stackTraceLimitMin:30},l=a.global;function p(t){return Object.keys(f).reduce((function(t,e){return t[e]||(t[e]=f[e]),t}),t)}t.exports=function(){if(arguments.length)throw new Error("react() takes no args, check API");r.ensureStackTraceLimitSet(f.stackTraceLimitMin);var t=a.create();t.parent=l;var e={name:void 0,inParams:[],tasks:[],outTask:{},locals:{}};function n(t){Object.keys(t).forEach((function(n){e[n]=t[n]}));var n=i(e);return n.length||s.nameTasks(e.tasks),Object.freeze&&(Object.keys(t).forEach((function(e){"object"==typeof t[e]&&Object.freeze(t[e])})),Object.freeze(t)),n}function h(n,r,i,f){var h=Array.prototype.slice.call(arguments),v={execId:c.createUniqueId(),args:h,ast:e,flowEmitter:t};v.name=e.name||v.execId,t.emit(a.TYPES.EXEC_FLOW_START,v);var y=u(h,e),m=o.create(y.args,e.inParams,e.locals,this);v.parsedInput=y,v.options=p(y.options),v.vCon=m,v.taskDefs=e.tasks.slice(),v.outTaskDef=Object.create(e.outTask),l.emit(a.TYPES.EXEC_TASKS_PRECREATE,v);var d=v.taskDefs.map(s.create),g=s.nameTasks(d),E=s.createOutTask(v.outTaskDef,y.cb,d,m,v.options,v),b=s.createErrorHandler(m,E);function w(){if(E.f)return E.isReady()?E.exec():void s.findReadyAndExec(m,d,g,b,w,v)}return d.forEach((function(e){e.id=c.createUniqueId(),e.env=v,e.prepare&&e.prepare(b,m,w,t)})),w(),E.retValue}var v=h;return v.ast=e,v.setAndValidateAST=n,v.events=t,v},t.exports.options=f,t.exports.events=l},function(t,e,n){"use strict";var r=n(0);e.ensureStackTraceLimitSet=function(t){(!Error.stackTraceLimit||Error.stackTraceLimit<t)&&(Error.stackTraceLimit=t)},e.augmentError=function(t,e){"string"==typeof t&&(t=new Error(t));var n=t.toString();return t.meta=e,t.toString=function(){return n+function(t){if(t.meta){var e,n=t.meta.vcon,i=t.meta.task,s="\n\n";return i&&i.f&&i.a&&(s+="Error occurs in Task function: "+((e=i.f)?e&&e.name?e.name:e:"undefined")+"("+i.a.join(",")+")\n\n"),n&&(s+="Variable Context: \n",s+=r.inspect(n),s+="\n\n"),i&&i.f&&(s+="Task Source:\n\n",s+=i.f.toString(),s+="\n\n"),s}}(t)},t}},function(t,e,n){"use strict";n.r(e);n(4)},function(t,e,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,s=i&&"function"==typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function c(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function f(t,e,n,r){var i,s,o,a;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(s=t._events)?(s=t._events=Object.create(null),t._eventsCount=0):(void 0!==s.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),void 0===o)o=s[e]=n,++t._eventsCount;else if("function"==typeof o?o=s[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=c(t))>0&&o.length>i&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=o.length,a=u,console&&console.warn&&console.warn(a)}return t}function l(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,s(this.listener,this.target,t))}function p(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=l.bind(r);return i.listener=n,r.wrapFn=i,i}function h(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):y(i,i.length)}function v(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");u=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var u=i[t];if(void 0===u)return!1;if("function"==typeof u)s(u,this,e);else{var c=u.length,f=y(u,c);for(n=0;n<c;++n)s(f[n],this,e)}return!0},a.prototype.addListener=function(t,e){return f(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return f(this,t,e,!0)},a.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.on(t,p(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.prependListener(t,p(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,r,i,s,o;if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);if(void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===e||n[s].listener===e){o=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,o||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,s=Object.keys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},a.prototype.listeners=function(t){return h(this,t,!0)},a.prototype.rawListeners=function(t){return h(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):v.call(t,e)},a.prototype.listenerCount=v,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(t,e){var n,r,i=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var u,c=[],f=!1,l=-1;function p(){f&&u&&(f=!1,u.length?c=u.concat(c):l=-1,c.length&&h())}function h(){if(!f){var t=a(p);f=!0;for(var e=c.length;e;){for(u=c,c=[];++l<e;)u&&u[l].run();l=-1,e=c.length}u=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function v(t,e){this.fun=t,this.array=e}function y(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new v(t,e)),1!==c.length||f||a(h)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";n(0);var r=n(1).sprintf,i=n(6),s=n(7),o="missing or mispelled variable referenced in flow definition: %s",a=/^(true|false|this|null|\-?[0-9\.]+)$|'|"|\./i;function u(t){return a.test(t)}t.exports=function(t){if(!(t&&t.inParams&&t.tasks&&t.outTask))return["ast must be an object with inParams, tasks, and outTask"];var e=[];return 0===(e=(e=(e=(e=(e=e.concat(function(t){if(!Array.isArray(t)||!t.every((function(t){return"string"==typeof t})))return["ast.inParams must be an array of strings"];return[]}(t.inParams))).concat(function(t){if(!Array.isArray(t))return["ast.tasks must be an array of tasks"];var e=[];return t.forEach((function(t){e=e.concat(s.validate(t))})),e}(t.tasks))).concat(function(t){if(!Array.isArray(t))return[];var e=[];return t.filter((function(t){return t.name})).map((function(t){return t.name})).reduce((function(t,n){return t[n]?e.push(r("%s %s","ast.tasks that specify name need to be unique, duplicate:",n)):t[n]=!0,t}),{}),e}(t.tasks))).concat(s.validateOutTask(t.outTask))).concat(function(t){var e=[];null===t&&e.push("ast.locals should not be null");return e}(t.locals))).length&&("finalcbFirst"!==t.outTask.type&&(e=e.concat(function(t){var e=[];return t.reduce((function(t,n){var s;return(s=n,i(s.out)).forEach((function(n){void 0!==t[n]?e.push(r("%s: %s","multiple tasks output the same param, must be unique. param",n)):t[n]=!0})),t}),{}),e}(t.tasks))),e=(e=e.concat(s.validateLocalFunctions(t.inParams,t.tasks,t.locals))).concat(function(t){var e=[],n={};t.locals&&(n=Object.keys(t.locals).reduce((function(t,e){return t[e]=!0,t}),n));return t.inParams.reduce((function(t,e){return t[e]=!0,t}),n),t.tasks.reduce((function(t,e){return e.out.reduce((function(t,e){return t[e]=!0,t}),t)}),n),t.tasks.reduce((function(t,e){return e.a.reduce((function(t,e){return u(e)||n[e]||t.push(r(o,e)),t}),t)}),e),t.outTask.a.reduce((function(t,e){return u(e)||n[e]||t.push(r(o,e)),t}),e),e}(t))),e}},function(t,e,n){"use strict";var r=n(0),i=n(1).sprintf,s=n(5);function o(t,e){return i("%s - %s",t,r.inspect(e))}function a(t){var e=this;Object.keys(t).forEach((function(n){e[n]=t[n]}))}a.prototype=new s,a.prototype.constructor=a,a.validate=function(t){var e=[];if(t.f&&t.a&&t.out){var n=typeof t.f;t.f instanceof Function||"string"===n||e.push(o("cbTask requires f to be a function or string",t)),Array.isArray(t.a)&&t.a.every((function(t){return"string"==typeof t}))||e.push(o("cbTask requires a to be an array of string param names",t)),Array.isArray(t.out)&&t.out.every((function(t){return"string"==typeof t}))||e.push(o("cbTask requires out to be an array of string param names",t))}else e.push(o("cbTask requires f, a, out",t));return e},a.prototype.prepare=function(t,e,n){var r=this;this.cbFun=function(i,s,o,a){var u=Array.prototype.slice.call(arguments,1);i?t(r,i):(e.saveResults(r.out,u),r.complete(u),n())}},a.prototype.exec=function(t,e,n){try{var r=this.a.map((function(e){return t.getVar(e)}));this.start(r),r.push(this.cbFun);var i=this.f,s=t.getVar("this");this.isMethodCall()?(i=t.getVar(this.f),s=this.getMethodObj(t)):"string"==typeof i&&(i=t.getVar(i)),i.apply(s,r)}catch(t){e(this,t)}},t.exports=a},function(t,e,n){var r;
/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */!function(i){var s=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(){this._events={},this._conf&&a.call(this,this._conf)}function a(t){t&&(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),t.maxListeners&&(this._events.maxListeners=t.maxListeners),t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this.newListener=t.newListener),this.wildcard&&(this.listenerTree={}))}function u(t){this._events={},this.newListener=!1,a.call(this,t)}function c(t,e,n,r){if(!n)return[];var i,s,o,a,u,f,l,p=[],h=e.length,v=e[r],y=e[r+1];if(r===h&&n._listeners){if("function"==typeof n._listeners)return t&&t.push(n._listeners),[n];for(i=0,s=n._listeners.length;i<s;i++)t&&t.push(n._listeners[i]);return[n]}if("*"===v||"**"===v||n[v]){if("*"===v){for(o in n)"_listeners"!==o&&n.hasOwnProperty(o)&&(p=p.concat(c(t,e,n[o],r+1)));return p}if("**"===v){for(o in(l=r+1===h||r+2===h&&"*"===y)&&n._listeners&&(p=p.concat(c(t,e,n,h))),n)"_listeners"!==o&&n.hasOwnProperty(o)&&("*"===o||"**"===o?(n[o]._listeners&&!l&&(p=p.concat(c(t,e,n[o],h))),p=p.concat(c(t,e,n[o],r))):p=o===y?p.concat(c(t,e,n[o],r+2)):p.concat(c(t,e,n[o],r)));return p}p=p.concat(c(t,e,n[v],r+1))}if((a=n["*"])&&c(t,e,a,r+1),u=n["**"])if(r<h)for(o in u._listeners&&c(t,e,u,h),u)"_listeners"!==o&&u.hasOwnProperty(o)&&(o===y?c(t,e,u[o],r+2):o===v?c(t,e,u[o],r+1):((f={})[o]=u[o],c(t,e,{"**":f},r+1)));else u._listeners?c(t,e,u,h):u["*"]&&u["*"]._listeners&&c(t,e,u["*"],h);return p}function f(t,e){for(var n=0,r=(t="string"==typeof t?t.split(this.delimiter):t.slice()).length;n+1<r;n++)if("**"===t[n]&&"**"===t[n+1])return;for(var i=this.listenerTree,o=t.shift();o;){if(i[o]||(i[o]={}),i=i[o],0===t.length){if(i._listeners){if("function"==typeof i._listeners)i._listeners=[i._listeners,e];else if(s(i._listeners)&&(i._listeners.push(e),!i._listeners.warned)){var a=10;void 0!==this._events.maxListeners&&(a=this._events.maxListeners),a>0&&i._listeners.length>a&&(i._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",i._listeners.length),console.trace())}}else i._listeners=e;return!0}o=t.shift()}return!0}u.prototype.delimiter=".",u.prototype.setMaxListeners=function(t){this._events||o.call(this),this._events.maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t},u.prototype.event="",u.prototype.once=function(t,e){return this.many(t,1,e),this},u.prototype.many=function(t,e,n){var r=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function i(){0==--e&&r.off(t,i),n.apply(this,arguments)}return i._origin=n,this.on(t,i),r},u.prototype.emit=function(){this._events||o.call(this);var t,e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var n=arguments.length,r=new Array(n-1),i=1;i<n;i++)r[i-1]=arguments[i];for(i=0,n=this._all.length;i<n;i++)this.event=e,this._all[i].apply(this,r)}if("error"===e&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(this.wildcard){t=[];var s="string"==typeof e?e.split(this.delimiter):e.slice();c.call(this,t,s,this.listenerTree,0)}else t=this._events[e];if("function"==typeof t){if(this.event=e,1===arguments.length)t.call(this);else if(arguments.length>1)switch(arguments.length){case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,r=new Array(n-1),i=1;i<n;i++)r[i-1]=arguments[i];t.apply(this,r)}return!0}if(t){for(n=arguments.length,r=new Array(n-1),i=1;i<n;i++)r[i-1]=arguments[i];var a=t.slice();for(i=0,n=a.length;i<n;i++)this.event=e,a[i].apply(this,r);return a.length>0||!!this._all}return!!this._all},u.prototype.on=function(t,e){if("function"==typeof t)return this.onAny(t),this;if("function"!=typeof e)throw new Error("on only accepts instances of Function");if(this._events||o.call(this),this.emit("newListener",t,e),this.wildcard)return f.call(this,t,e),this;if(this._events[t]){if("function"==typeof this._events[t])this._events[t]=[this._events[t],e];else if(s(this._events[t])&&(this._events[t].push(e),!this._events[t].warned)){var n=10;void 0!==this._events.maxListeners&&(n=this._events.maxListeners),n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}}else this._events[t]=e;return this},u.prototype.onAny=function(t){if("function"!=typeof t)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(t),this},u.prototype.addListener=u.prototype.on,u.prototype.off=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");var n,r=[];if(this.wildcard){var i="string"==typeof t?t.split(this.delimiter):t.slice();r=c.call(this,null,i,this.listenerTree,0)}else{if(!this._events[t])return this;n=this._events[t],r.push({_listeners:n})}for(var o=0;o<r.length;o++){var a=r[o];if(n=a._listeners,s(n)){for(var u=-1,f=0,l=n.length;f<l;f++)if(n[f]===e||n[f].listener&&n[f].listener===e||n[f]._origin&&n[f]._origin===e){u=f;break}if(u<0)continue;return this.wildcard?a._listeners.splice(u,1):this._events[t].splice(u,1),0===n.length&&(this.wildcard?delete a._listeners:delete this._events[t]),this}(n===e||n.listener&&n.listener===e||n._origin&&n._origin===e)&&(this.wildcard?delete a._listeners:delete this._events[t])}return this},u.prototype.offAny=function(t){var e,n=0,r=0;if(t&&this._all&&this._all.length>0){for(n=0,r=(e=this._all).length;n<r;n++)if(t===e[n])return e.splice(n,1),this}else this._all=[];return this},u.prototype.removeListener=u.prototype.off,u.prototype.removeAllListeners=function(t){if(0===arguments.length)return!this._events||o.call(this),this;if(this.wildcard)for(var e="string"==typeof t?t.split(this.delimiter):t.slice(),n=c.call(this,null,e,this.listenerTree,0),r=0;r<n.length;r++){var i=n[r];i._listeners=null}else{if(!this._events[t])return this;this._events[t]=null}return this},u.prototype.listeners=function(t){if(this.wildcard){var e=[],n="string"==typeof t?t.split(this.delimiter):t.slice();return c.call(this,e,n,this.listenerTree,0),e}return this._events||o.call(this),this._events[t]||(this._events[t]=[]),s(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},u.prototype.listenersAny=function(){return this._all?this._all:[]},void 0===(r=function(){return u}.call(e,n,e,t))||(t.exports=r)}()},function(t,e,n){"use strict";var r=n(0),i=n(1).sprintf,s=n(5);function o(t,e){return i("%s - %s",t,r.inspect(e))}function a(t){var e=this;Object.keys(t).forEach((function(n){e[n]=t[n]}))}a.prototype=new s,a.prototype.constructor=a,a.validate=function(t){var e=[];if(t.f&&t.a&&t.out){var n=typeof t.f;t.f instanceof Function||"string"===n||e.push(o("promiseTask requires f to be a function or string",t)),Array.isArray(t.a)&&t.a.every((function(t){return"string"==typeof t}))||e.push(o("promiseTask requires a to be an array of string param names",t)),Array.isArray(t.out)&&t.out.length<=1&&t.out.every((function(t){return"string"==typeof t}))||e.push(o("promiseTask requires out to be an array[1] of string param names",t))}else e.push(o("promiseTask requires f, a, out",t));return e},a.prototype.prepare=function(t,e,n){var r=this;this.nextFn=function(t){var i=Array.prototype.slice.call(arguments);e.saveResults(r.out,i),r.complete(i),n()},this.failFn=function(e){t(r,e)}},a.prototype.exec=function(t,e,n){try{var r=this.a.map((function(e){return t.getVar(e)}));this.start(r);var i=this.f,s=t.getVar("this");this.isMethodCall()?(i=t.getVar(this.f),s=this.getMethodObj(t)):"string"==typeof i&&(i=t.getVar(i));var o=i.apply(s,r);o&&"function"==typeof o.then?o.then(this.nextFn,this.failFn):this.nextFn(o)}catch(t){e(this,t)}},t.exports=a},function(t,e,n){"use strict";var r=n(0),i=n(1).sprintf,s=n(5);function o(t,e){return i("%s - %s",t,r.inspect(e))}function a(t){var e=this;Object.keys(t).forEach((function(n){e[n]=t[n]}))}a.prototype=new s,a.prototype.constructor=a,a.validate=function(t){var e=[];if(t.f&&t.a&&t.out){var n=typeof t.f;t.f instanceof Function||"string"===n||e.push(o("retTask requires f to be a function or string",t)),Array.isArray(t.a)&&t.a.every((function(t){return"string"==typeof t}))||e.push(o("retTask requires a to be an array of string param names",t)),Array.isArray(t.out)&&(0===t.out.length||1===t.out.length&&(t.out[0],1))||e.push(o("retTask requires out to be an array with single string param name or []",t))}else e.push(o("retTask requires f, a, out",t));return e},a.prototype.exec=function(t,e,n){try{var r=this.a.map((function(e){return t.getVar(e)}));this.start(r);var i=this.f,s=t.getVar("this");this.isMethodCall()?(i=t.getVar(this.f),s=this.getMethodObj(t)):"string"==typeof i&&(i=t.getVar(i));var o=[i.apply(s,r)];t.saveResults(this.out,o),this.complete(o),n()}catch(t){e(this,t)}},t.exports=a},function(t,e,n){"use strict";var r=n(0),i=n(1).sprintf,s=n(5);function o(t,e){return i("%s - %s",t,r.inspect(e))}function a(t){var e=this;Object.keys(t).forEach((function(n){e[n]=t[n]}))}a.prototype=new s,a.prototype.constructor=a,a.prototype.f=function(){},a.validate=function(t){var e=[];return t.a&&t.out?(Array.isArray(t.a)&&1===t.a.length&&t.a.every((function(t){return"string"==typeof t}))||e.push(o("whenTask requires a to be an array[1] of string param names",t)),Array.isArray(t.out)&&t.out.length<=1&&t.out.every((function(t){return"string"==typeof t}))||e.push(o("whenTask requires out to be an array[1] of string param names",t))):e.push(o("whenTask requires a, out",t)),e},a.prototype.prepare=function(t,e,n){var r=this;this.nextFn=function(t){var i=Array.prototype.slice.call(arguments);e.saveResults(r.out,i),r.complete(i),n()},this.failFn=function(e){t(r,e)}},a.prototype.exec=function(t,e,n){try{var r=this.a.map((function(e){return t.getVar(e)}));this.start(r);var i=r[0];i&&"function"==typeof i.then?i.then(this.nextFn,this.failFn):this.nextFn(i)}catch(t){e(this,t)}},t.exports=a},function(t,e,n){"use strict";var r=n(1).sprintf,i=n(0),s=n(3),o=n(2);function a(t){var e=t.taskDef;if("function"!=typeof t.cbFunc)throw new Error("callback is not a function");for(var n in e)this[n]=e[n];this.f=t.cbFunc,this.tasks=t.tasks,this.vCon=t.vCon,this.retValue=t.retValue,this.execOptions=t.execOptions,this.env=t.env}a.validate=function(t){var e,n=[];return Array.isArray(t.a)&&t.a.every((function(t){return"string"==typeof t}))||n.push((e=t,r("%s - %s","ast.outTask.a should be an array of string param names",i.inspect(e)))),n},a.prototype.isReady=function(){return this.tasks.every((function(t){return t.status===s.COMPLETE}))},a.prototype.exec=function(t){if(this.f){if(t)this.env.error=t,this.env.flowEmitter.emit(o.TYPES.EXEC_FLOW_ERRORED,this.env),this.f.call(null,t);else{var e=this.vCon,n=this.a.map((function(t){return e.getVar(t)}));n.unshift(null),this.env.results=n,this.env.flowEmitter.emit(o.TYPES.EXEC_FLOW_COMPLETE,this.env),this.f.apply(null,n)}this.f=null}},t.exports=a},function(t,e,n){"use strict";var r=n(1).sprintf,i=n(0),s=(n(3),n(8),n(2));function o(t){var e=t.taskDef;if("function"!=typeof t.cbFunc)throw new Error("callback is not a function");for(var n in e)this[n]=e[n];this.f=t.cbFunc,this.tasks=t.tasks,this.vCon=t.vCon,this.retValue=t.retValue,this.env=t.env}o.validate=function(t){var e,n=[];return Array.isArray(t.a)&&t.a.every((function(t){return"string"==typeof t}))||n.push((e=t,r("%s - %s","ast.outTask.a should be an array of string param names",i.inspect(e)))),n},o.prototype.isReady=function(){var t=this.vCon.getLastResults();return!!t&&t.some((function(t){return null!=t}))},o.prototype.exec=function(t){if(this.f){if(t)this.env.error=t,this.env.flowEmitter.emit(s.TYPES.EXEC_FLOW_ERRORED,this.env),this.f.call(null,t);else{var e=this.vCon,n=this.a.map((function(t){return e.getVar(t)}));n.unshift(null),this.env.results=n,this.env.flowEmitter.emit(s.TYPES.EXEC_FLOW_COMPLETE,this.env),this.f.apply(null,n)}this.f=null}},t.exports=o},function(t,e,n){"use strict";var r=n(2),i={reactExecOptions:!0,outputStyle:"cb"},s="cb";function o(t){return t&&t.reactExecOptions}function a(t){return o(t)}function u(t){return!o(t)}function c(t,e){return Object.keys(e).forEach((function(n){t[n]=e[n]})),t}t.exports=function(t,e){var n={},o=t.filter(a);o.unshift(i),n.options=o.reduce(c,{});var f=function(t,e,n){var r={};return r.args=e.map((function(e){return t.shift()})),n===s&&t.length&&(r.cb=t.shift()),r.extra=t,r}(t.filter(u),e.inParams,n.options.outputStyle);return n.args=f.args,n.cb=f.cb,f.outputStyle&&(n.options.outputStyle=f.outputStyle),f.extra&&(n.extraArgs=f.extra),r.global.emit(r.TYPES.EXEC_INPUT_PREPROCESS,n),n},t.exports.defaultExecOptions=i},function(t,e,n){"use strict";var r=0;e.createUniqueId=function(){return r+=1}},function(t,e,n){"use strict";var r=n(0),i=n(4);i.trackTasks();var s=/^flow\./;function o(t){var e=new Date;e.setTime(t.time);var n=t.args.filter((function(t){return"function"!=typeof t}));e.toISOString();if("flow.complete"===this.event){var i=t;console.error("%s: %s \tmsecs: %s \n\targs: %s \n\tresults: %s\n",this.event,i.name,i.elapsedTime,r.inspect(n),r.inspect(i.results))}else{var s=t.name;t.args;console.error("%s: %s \n\targs: %s\n",this.event,s,r.inspect(n))}}function a(t){var e=new Date;e.setTime(t.time);var n=t.args.filter((function(t){return"function"!=typeof t}));e.toISOString();if("task.complete"===this.event){var i=t;console.error("%s: %s \tmsecs: %s \n\targs: %s \n\tresults: %s\n",this.event,i.name,i.elapsedTime,r.inspect(n),r.inspect(i.results))}else{var s=t.name;t.args;console.error("%s: %s \n\targs: %s\n",this.event,s,r.inspect(n))}}t.exports=i,t.exports.logEvents=function(t,e){if(t||(t=i),e&&"*"!==e){var n=s.test(e)?o:a;t.events.removeListener(e,n),t.events.on(e,n)}else t.events.removeListener("flow.*",o),t.events.on("flow.*",o),t.events.removeListener("task.*",a),t.events.on("task.*",a)}},function(t,e,n){"use strict";var r=n(4);r.events.on(r.events.TYPES.EXEC_TASKS_PRECREATE,(function(t){var e=t.vCon.values;t.ast.inParams.filter((function(t){var n=e[t];return n&&"function"==typeof n.then})).forEach((function(n){var r=n+"__promise";e[r]=e[n],e[n]=void 0,t.taskDefs.push({type:"when",a:[r],out:[n]})}))})),t.exports=r},function(t,e,n){"use strict";var r=n(4);r.events.on(r.events.TYPES.EXEC_FLOW_START,(function(t){t.startTime=Date.now(),t.flowEmitter.emit(r.events.TYPES.FLOW_BEGIN,t)})),r.events.on(r.events.TYPES.EXEC_TASK_START,(function(t){t.startTime=Date.now(),t.env.flowEmitter.emit(r.events.TYPES.TASK_BEGIN,t)})),r.events.on(r.events.TYPES.EXEC_TASK_COMPLETE,(function(t){t.endTime=Date.now(),t.elapsedTime=t.endTime-t.startTime,t.env.flowEmitter.emit(r.events.TYPES.TASK_COMPLETE,t)})),r.events.on(r.events.TYPES.EXEC_TASK_ERRORED,(function(t){t.endTime=Date.now(),t.elapsedTime=t.endTime-t.startTime,t.env.flowEmitter.emit(r.events.TYPES.TASK_ERRORED,t)})),r.events.on(r.events.TYPES.EXEC_FLOW_COMPLETE,(function(t){t.endTime=Date.now(),t.elapsedTime=t.endTime-t.startTime,t.flowEmitter.emit(r.events.TYPES.FLOW_COMPLETE,t)})),r.events.on(r.events.TYPES.EXEC_FLOW_ERRORED,(function(t){t.endTime=Date.now(),t.elapsedTime=t.endTime-t.startTime,t.flowEmitter.emit(r.events.TYPES.FLOW_ERRORED,t)})),t.exports=r},function(t,e,n){"use strict";var r=n(1).sprintf,i=n(9),s=n(30),o=n(7),a="first flow parameter should be the flow name, but found in/out def: %s",u=/\->/,c=/^cb|callback$/i,f=/^err$/i;function l(t){return t.length&&t[t.length-1].match(c)&&t.pop(),t}var p={splitStr:"->",fn:function(t,e){var n,i=s.splitTrimFilterArgs(t[0]),o=i[i.length-1],a=o&&c.test(o)?"cb":"ret",u=s.splitTrimFilterArgs(t[1]),p=u[0];if(!("cb"!==a||p&&f.test(p)))throw new Error(r('callback specified, but first out param was not "err", use for clarity. Found in/out def: %s',e));if("ret"===a&&p&&f.test(p))throw new Error(r("found err param, but cb/callback is not specified, is this cb-style async or sync function? Found in/out def: %s",e));return{type:a,inDef:l(i),outDef:(n=u,n.length&&n[0].match(f)&&n.shift(),n)}}};function h(t){var e=s.parseStr(t,[p],'params in wrong format, wanted "foo, bar, cb -> err, baz" - found: %s');return e.inDef=l(e.inDef),e}function v(t){for(var e,n,i,s=[];t.length>=2;){n={},e=t.shift(),i=h(t.shift()),"object"==typeof t[0]&&(n=t.shift()),n.f=e,n.a=i.inDef;var o=i.type;n.out=i.outDef,n.type=o,s.push(n)}if(t.length)throw new Error(r("extra unmatched task arg: %s",t[0]));return s}function y(t){var e=t.shift()||"",n=t.length&&"object"==typeof t[0]?t.shift():{};return{inOutParamStr:e,taskDefArr:t,options:n}}t.exports=function(t,e,n,s){var o=i();if(t&&u.test(t))throw new Error(r(a,t));var c=y(Array.prototype.slice.call(arguments,1)),f=h(c.inOutParamStr),l={name:t,inParams:f.inDef,tasks:v(c.taskDefArr),outTask:{a:f.outDef}};c.options&&Object.keys(c.options).forEach((function(t){l[t]=c.options[t]}));var p=o.setAndValidateAST(l);if(p.length){var m=p.join("\n");throw new Error(m)}return o},t.exports.selectFirst=function(t,e,n,r){var s=i(),a=y(Array.prototype.slice.call(arguments,1)),u=h(a.inOutParamStr),c=o.serializeTasks(v(a.taskDefArr)),f={name:t,inParams:u.inDef,tasks:c,outTask:{type:"finalcbFirst",a:u.outDef}};a.options&&Object.keys(a.options).forEach((function(t){f[t]=a.options[t]}));var l=s.setAndValidateAST(f);if(l.length){var p=l.join("\n");throw new Error(p)}return s}},function(t,e,n){"use strict";var r=n(1).sprintf;function i(t,e){if("string"!=typeof t)return t;var n=e.regex?e.regex.exec(t):t.split(e.splitStr);return n?e.fn(n,t):t}e.splitTrimFilterArgs=function(t){return t?t.split(",").map((function(t){return t.trim()})).filter((function(t){return t})):[]},e.parseStr=function(t,e,n){var s=e.reduce(i,t);if("string"!=typeof s)return s;throw new Error(r(n,t))}}]);